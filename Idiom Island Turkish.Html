<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deyim AdasÄ± MacerasÄ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Inter:wght@400;500;600;700&display=swap');
        
        .game-font { font-family: 'Fredoka One', cursive; }
        .body-font { font-family: 'Inter', sans-serif; }
        
        .island-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .zone-card {
            transition: all 0.3s ease;
            transform: translateY(0);
        }
        
        .zone-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .zone-locked {
            opacity: 0.6;
            filter: grayscale(100%);
        }
        
        .progress-bar {
            transition: width 0.5s ease;
        }
        
        .drag-item {
            cursor: grab;
            transition: all 0.2s ease;
        }
        
        .drag-item:hover {
            transform: scale(1.05);
        }
        
        .drop-zone {
            min-height: 60px;
            transition: all 0.2s ease;
        }
        
        .drop-zone.drag-over {
            background-color: #e0f2fe;
            border-color: #0284c7;
        }
        
        .correct-match {
            background-color: #dcfce7 !important;
            border-color: #16a34a !important;
        }
        
        .wrong-match {
            background-color: #fef2f2 !important;
            border-color: #dc2626 !important;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .bounce-animation {
            animation: bounce 0.6s;
        }
        
        .timer-warning {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body class="island-bg body-font">
    <div id="app" class="min-h-screen">
        <!-- Main Menu -->
        <div id="mainMenu" class="container mx-auto px-4 py-8">
            <div class="text-center mb-12">
                <h1 class="game-font text-6xl text-white mb-4">ğŸï¸ Deyim AdasÄ± MacerasÄ±</h1>
                <p class="text-xl text-blue-100 mb-8">Heyecan verici ada maceralarÄ± ile TÃ¼rkÃ§e deyimleri Ã¶ÄŸren!</p>
                
                <!-- Player Stats -->
                <div class="bg-white/20 backdrop-blur-sm rounded-2xl p-6 max-w-md mx-auto mb-8">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-white font-semibold">Toplam Puan:</span>
                        <span id="totalScore" class="text-2xl font-bold text-yellow-300">0</span>
                    </div>
                    <div class="w-full bg-white/20 rounded-full h-3">
                        <div id="overallProgress" class="progress-bar bg-gradient-to-r from-yellow-400 to-orange-500 h-3 rounded-full" style="width: 0%"></div>
                    </div>
                    <p class="text-blue-100 text-sm mt-2">Deyim UstasÄ±'na Ä°lerleme</p>
                </div>
            </div>
            
            <!-- Zone Selection -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto">
                <!-- Zone 1: Match-Up Bay -->
                <div class="zone-card bg-white rounded-2xl p-6 shadow-xl" data-zone="1">
                    <div class="text-center">
                        <div class="text-4xl mb-4">ğŸ–ï¸</div>
                        <h3 class="game-font text-2xl text-blue-600 mb-2">Match-Up Bay</h3>
                        <p class="text-gray-600 mb-4">Deyimleri anlamlarÄ±yla eÅŸleÅŸtir</p>
                        <div class="flex justify-between text-sm text-gray-500 mb-4">
                            <span>Maks: 100 puan</span>
                            <span id="zone1Score">Puan: 0</span>
                        </div>
                        <button onclick="startZone(1)" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-full font-semibold transition-colors">
                            Maceraya BaÅŸla
                        </button>
                    </div>
                </div>
                
                <!-- Zone 2: Bluff Cliffs -->
                <div class="zone-card bg-white rounded-2xl p-6 shadow-xl zone-locked" data-zone="2">
                    <div class="text-center">
                        <div class="text-4xl mb-4">â›°ï¸</div>
                        <h3 class="game-font text-2xl text-gray-400 mb-2">Bluff Cliffs</h3>
                        <p class="text-gray-400 mb-4">DoÄŸru veya yanlÄ±ÅŸ sorularÄ±</p>
                        <div class="flex justify-between text-sm text-gray-400 mb-4">
                            <span>Maks: 100 puan</span>
                            <span id="zone2Score">Puan: 0</span>
                        </div>
                        <button class="bg-gray-300 text-gray-500 px-6 py-2 rounded-full font-semibold cursor-not-allowed">
                            ğŸ”’ Kilitli
                        </button>
                    </div>
                </div>
                
                <!-- Zone 3: Treasure Trove -->
                <div class="zone-card bg-white rounded-2xl p-6 shadow-xl zone-locked" data-zone="3">
                    <div class="text-center">
                        <div class="text-4xl mb-4">ğŸ’</div>
                        <h3 class="game-font text-2xl text-gray-400 mb-2">Treasure Trove</h3>
                        <p class="text-gray-400 mb-4">BoÅŸluklarÄ± doldur</p>
                        <div class="flex justify-between text-sm text-gray-400 mb-4">
                            <span>Maks: 150 puan</span>
                            <span id="zone3Score">Puan: 0</span>
                        </div>
                        <button class="bg-gray-300 text-gray-500 px-6 py-2 rounded-full font-semibold cursor-not-allowed">
                            ğŸ”’ Kilitli
                        </button>
                    </div>
                </div>
                
                <!-- Zone 4: Lightning Lagoon -->
                <div class="zone-card bg-white rounded-2xl p-6 shadow-xl zone-locked" data-zone="4">
                    <div class="text-center">
                        <div class="text-4xl mb-4">âš¡</div>
                        <h3 class="game-font text-2xl text-gray-400 mb-2">Lightning Lagoon</h3>
                        <p class="text-gray-400 mb-4">HÄ±zlÄ± quiz</p>
                        <div class="flex justify-between text-sm text-gray-400 mb-4">
                            <span>Maks: 100 puan</span>
                            <span id="zone4Score">Puan: 0</span>
                        </div>
                        <button class="bg-gray-300 text-gray-500 px-6 py-2 rounded-full font-semibold cursor-not-allowed">
                            ğŸ”’ Kilitli
                        </button>
                    </div>
                </div>
                
                <!-- Zone 5: Idiom Maze -->
                <div class="zone-card bg-white rounded-2xl p-6 shadow-xl zone-locked" data-zone="5">
                    <div class="text-center">
                        <div class="text-4xl mb-4">ğŸŒ€</div>
                        <h3 class="game-font text-2xl text-gray-400 mb-2">The Idiom Maze</h3>
                        <p class="text-gray-400 mb-4">Senaryo maceralarÄ±</p>
                        <div class="flex justify-between text-sm text-gray-400 mb-4">
                            <span>Maks: 150 puan</span>
                            <span id="zone5Score">Puan: 0</span>
                        </div>
                        <button class="bg-gray-300 text-gray-500 px-6 py-2 rounded-full font-semibold cursor-not-allowed">
                            ğŸ”’ Kilitli
                        </button>
                    </div>
                </div>
                
                <!-- Achievement Badge -->
                <div class="zone-card bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-6 shadow-xl">
                    <div class="text-center text-white">
                        <div class="text-4xl mb-4">ğŸ†</div>
                        <h3 class="game-font text-2xl mb-2">Seviyeniz</h3>
                        <p id="playerRank" class="text-lg font-semibold mb-2">Pratik Yapmaya Devam</p>
                        <div class="text-sm opacity-90">
                            <div>ğŸ† 500+ puan: Åampiyon</div>
                            <div>ğŸ§­ 400+ puan: KaÅŸif</div>
                            <div>ğŸ’¡ 0+ puan: Pratik</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Game Screens -->
        <div id="gameScreen" class="hidden container mx-auto px-4 py-8">
            <!-- Game Header -->
            <div class="bg-white/20 backdrop-blur-sm rounded-2xl p-4 mb-6">
                <div class="flex justify-between items-center">
                    <button onclick="returnToMenu()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-colors">
                        â† Adaya DÃ¶n
                    </button>
                    <div class="text-center">
                        <h2 id="zoneTitle" class="game-font text-2xl text-white"></h2>
                        <p id="zoneDescription" class="text-blue-100"></p>
                    </div>
                    <div class="text-right">
                        <div class="text-white font-semibold">Puan: <span id="currentScore">0</span></div>
                        <div id="timerDisplay" class="text-yellow-300 font-bold hidden"></div>
                    </div>
                </div>
            </div>
            
            <!-- Zone 1: Match-Up Bay -->
            <div id="zone1Game" class="hidden">
                <div class="bg-white rounded-2xl p-6 shadow-xl">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-semibold">Ä°lerleme</span>
                            <span id="matchProgress">0/10</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="matchProgressBar" class="progress-bar bg-blue-500 h-3 rounded-full" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="font-bold text-lg mb-4 text-center">Deyimler</h3>
                            <div id="idiomsColumn" class="space-y-3"></div>
                        </div>
                        <div>
                            <h3 class="font-bold text-lg mb-4 text-center">Anlamlar</h3>
                            <div id="meaningsColumn" class="space-y-3"></div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-6">
                        <button id="checkMatches" onclick="checkMatches()" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full font-semibold transition-colors">
                            CevaplarÄ± Kontrol Et
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Zone 2: True/False -->
            <div id="zone2Game" class="hidden">
                <div class="bg-white rounded-2xl p-6 shadow-xl max-w-2xl mx-auto">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-semibold">Soru <span id="tfQuestionNum">1</span>/10</span>
                            <span class="text-red-500 font-semibold">Hak: <span id="livesCount">3</span> â¤ï¸</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="tfProgressBar" class="progress-bar bg-purple-500 h-3 rounded-full" style="width: 10%"></div>
                        </div>
                    </div>
                    
                    <div class="text-center mb-8">
                        <div class="bg-blue-50 rounded-xl p-6 mb-6">
                            <h3 class="text-2xl font-bold text-blue-600 mb-4" id="tfIdiom"></h3>
                            <p class="text-lg text-gray-700" id="tfDefinition"></p>
                        </div>
                        
                        <div class="space-x-4">
                            <button onclick="answerTrueFalse(true)" class="bg-green-500 hover:bg-green-600 text-white px-8 py-4 rounded-full font-bold text-xl transition-colors">
                                âœ“ DOÄRU
                            </button>
                            <button onclick="answerTrueFalse(false)" class="bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-full font-bold text-xl transition-colors">
                                âœ— YANLIÅ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Zone 3: Fill in the Blank -->
            <div id="zone3Game" class="hidden">
                <div class="bg-white rounded-2xl p-6 shadow-xl max-w-2xl mx-auto">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-semibold">Soru <span id="fibQuestionNum">1</span>/10</span>
                            <span class="font-semibold">Bonus Mevcut! ğŸ“</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="fibProgressBar" class="progress-bar bg-green-500 h-3 rounded-full" style="width: 10%"></div>
                        </div>
                    </div>
                    
                    <div class="text-center mb-8">
                        <div class="bg-green-50 rounded-xl p-6 mb-6">
                            <p class="text-lg text-gray-700 mb-4" id="fibSentence"></p>
                            <select id="fibSelect" class="border-2 border-green-300 rounded-lg px-4 py-2 text-lg font-semibold bg-white">
                                <option value="">Bir deyim seÃ§in...</option>
                            </select>
                        </div>
                        
                        <button onclick="submitFillBlank()" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full font-semibold transition-colors mb-4">
                            CevabÄ± GÃ¶nder
                        </button>
                        
                        <div class="border-t pt-4">
                            <p class="text-sm text-gray-600 mb-2">Bonus: Bu deyimle kendi cÃ¼mleni oluÅŸtur!</p>
                            <textarea id="bonusSentence" placeholder="Bu deyimi kullanarak kendi cÃ¼mleni yaz..." class="w-full border-2 border-gray-300 rounded-lg p-3 text-sm"></textarea>
                            <button onclick="submitBonus()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-semibold mt-2 transition-colors">
                                Bonus Ä°Ã§in GÃ¶nder (+5 puan)
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Zone 4: Lightning Round -->
            <div id="zone4Game" class="hidden">
                <div class="bg-white rounded-2xl p-6 shadow-xl max-w-2xl mx-auto">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-semibold">Soru <span id="lrQuestionNum">1</span>/20</span>
                            <span id="lrTimer" class="text-2xl font-bold text-red-500">60</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="lrProgressBar" class="progress-bar bg-yellow-500 h-3 rounded-full" style="width: 5%"></div>
                        </div>
                    </div>
                    
                    <div class="text-center mb-8">
                        <div class="bg-yellow-50 rounded-xl p-6 mb-6">
                            <h3 class="text-2xl font-bold text-yellow-600 mb-4" id="lrIdiom"></h3>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4" id="lrOptions">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Zone 5: Scenario Game -->
            <div id="zone5Game" class="hidden">
                <div class="bg-white rounded-2xl p-6 shadow-xl max-w-3xl mx-auto">
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-2">
                            <span class="font-semibold">Senaryo <span id="scenarioNum">1</span>/8</span>
                            <span class="font-semibold">Son Meydan Okuma! ğŸŒŸ</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-3">
                            <div id="scenarioProgressBar" class="progress-bar bg-purple-500 h-3 rounded-full" style="width: 12.5%"></div>
                        </div>
                    </div>
                    
                    <div class="mb-8">
                        <div class="bg-purple-50 rounded-xl p-6 mb-6">
                            <h3 class="text-xl font-bold text-purple-600 mb-4" id="scenarioTitle"></h3>
                            <p class="text-gray-700 mb-4" id="scenarioDescription"></p>
                            <p class="font-semibold text-gray-800" id="scenarioQuestion"></p>
                        </div>
                        
                        <div class="space-y-3" id="scenarioOptions">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Results Modal -->
        <div id="resultsModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center">
                <div id="resultsIcon" class="text-6xl mb-4"></div>
                <h3 id="resultsTitle" class="game-font text-2xl mb-4"></h3>
                <p id="resultsMessage" class="text-gray-600 mb-6"></p>
                <div id="resultsScore" class="text-3xl font-bold text-blue-600 mb-6"></div>
                <button onclick="closeResults()" class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-full font-semibold transition-colors">
                    Maceraya Devam Et
                </button>
            </div>
        </div>
    </div>

    <script>
        // Game Data
        const gameData = {
            totalScore: 0,
            zoneScores: [0, 0, 0, 0, 0],
            bestScores: [0, 0, 0, 0, 0], // Track best scores separately
            unlockedZones: [true, false, false, false, false],
            currentZone: 0,
            currentQuestion: 0,
            gameState: {}
        };

        // Turkish Idioms Database
        const idiomsData = {
            zone1: [
                { idiom: "Nokta koymak", meaning: "Bir iÅŸi kesin olarak bitirmek" },
                { idiom: "AyaÄŸÄ±nÄ± yorganÄ±na gÃ¶re uzatmak", meaning: "HarcamalarÄ± gelirine gÃ¶re ayarlamak" },
                { idiom: "KafasÄ± taÅŸa Ã§arpmak", meaning: "AÅŸÄ±rÄ± dÃ¼ÅŸÃ¼nmek, kafayÄ± takmak" },
                { idiom: "DÃ¶rt baÅŸÄ± mamur", meaning: "Eksiksiz, tam" },
                { idiom: "GÃ¶zden kaÃ§mak", meaning: "Fark edilmemek" },
                { idiom: "Ä°ki ucu boklu deÄŸnek", meaning: "ZararlÄ± iki seÃ§enek arasÄ±nda kalmak" },
                { idiom: "TaÅŸ atsan kolun yorulur", meaning: "Ã‡ok yoÄŸun iÅŸ veya uÄŸraÅŸ" },
                { idiom: "GÃ¶ze girmek", meaning: "BeÄŸeni kazanmak" },
                { idiom: "SÄ±rtÄ± sÄ±vazlanmak", meaning: "Ã–vÃ¼lmek, takdir edilmek" },
                { idiom: "Ä°ÅŸin iÃ§inden Ã§Ä±kmak", meaning: "Ã‡Ä±kÄ±lmasÄ± zor duruma dÃ¼ÅŸmek" }
            ],
            zone2: [
                { idiom: "Dereyi gÃ¶rmeden paÃ§ayÄ± sÄ±vama", meaning: "Ä°ÅŸ bitmeden sevinme", correct: true },
                { idiom: "EÅŸek hoÅŸaftan ne anlar", meaning: "DeÄŸersiz kiÅŸi deÄŸerli ÅŸeyi anlayamaz", correct: true },
                { idiom: "El elden Ã¼stÃ¼ndÃ¼r", meaning: "Herkes aynÄ± yetenektedir", correct: false },
                { idiom: "KaÃ§an balÄ±k bÃ¼yÃ¼kmÃ¼ÅŸ", meaning: "Olmayan bir ÅŸeyi daha deÄŸerli gÃ¶rmek", correct: true },
                { idiom: "GÃ¶z var nizam var", meaning: "GÃ¶zlemci varken davranÄ±ÅŸa dikkat etmek", correct: true },
                { idiom: "Acele iÅŸe ÅŸeytan karÄ±ÅŸÄ±r", meaning: "Acele iÅŸ kÃ¶tÃ¼ sonuÃ§lanÄ±r", correct: true },
                { idiom: "BalÄ±k kavaÄŸa Ã§Ä±kÄ±nca", meaning: "OlasÄ± olmayan bir durumu ifade eder", correct: true },
                { idiom: "AyÄ±psÄ±z dost arayan dostsuz kalÄ±r", meaning: "MÃ¼kemmel arkadaÅŸ bulunamaz", correct: true },
                { idiom: "YalancÄ±nÄ±n mumu yatsÄ±ya kadar yanar", meaning: "Yalan kÄ±sa sÃ¼rede ortaya Ã§Ä±kar", correct: true },
                { idiom: "Sinekten yaÄŸ Ã§Ä±karmak", meaning: "Ä°mkansÄ±zÄ± baÅŸarmaya Ã§alÄ±ÅŸmak", correct: true }
            ],
            zone3: [
                { sentence: "Ä°ÅŸler daha kÃ¶tÃ¼ye giderse _____ ve sorumluluÄŸu al.", answer: "topu taÅŸa vurmak", options: ["topu taÅŸa vurmak", "ayaÄŸÄ±nÄ± yorganÄ±na gÃ¶re uzatmak", "gÃ¶zden kaÃ§mak", "nokta koymak"] },
                { sentence: "Fikirleri birbirine karÄ±ÅŸtÄ±rma; Ã¶nce _____.", answer: "aklÄ±nÄ± baÅŸÄ±na al", options: ["aklÄ±nÄ± baÅŸÄ±na al", "iÅŸin iÃ§inden Ã§Ä±kmak", "gÃ¶ze girmek", "kafasÄ± taÅŸa Ã§arpmak"] },
                { sentence: "Yeni projeye baÅŸlamak _____ gibi.", answer: "Ã§ocuk oyuncaÄŸÄ±", options: ["dÃ¶rt baÅŸÄ± mamur", "kafasÄ± taÅŸa Ã§arpmak", "Ã§ocuk oyuncaÄŸÄ±", "acele iÅŸe ÅŸeytan karÄ±ÅŸÄ±r"] },
                { sentence: "HarcamalarÄ± azaltmak iÃ§in _____.", answer: "ayaÄŸÄ±nÄ± yorganÄ±na gÃ¶re uzat", options: ["ayaÄŸÄ±nÄ± yorganÄ±na gÃ¶re uzat", "nokta koymak", "taÅŸ atsan kolun yorulur", "sÄ±rtÄ± sÄ±vazlanmak"] },
                { sentence: "Kendine fazla yÃ¼klenme, bazen _____ gerekir.", answer: "nefes almak", options: ["nefes almak", "balÄ±k kavaÄŸa Ã§Ä±kÄ±nca", "iÅŸin iÃ§inden Ã§Ä±kmak", "gÃ¶zden kaÃ§mak"] },
                { sentence: "Ã‡ok Ã¶vÃ¼ldÃ¼, artÄ±k _____ zamanÄ±.", answer: "sÄ±rtÄ± sÄ±vazlandÄ±", options: ["sÄ±rtÄ± sÄ±vazlandÄ±", "ayaÄŸÄ±nÄ± yorganÄ±na gÃ¶re uzat", "nokta koymak", "gÃ¶ze girmek"] },
                { sentence: "Bu durumda ne yapacaÄŸÄ±mÄ±zÄ± _____ bakmalÄ±yÄ±z.", answer: "iki ucu boklu deÄŸnek", options: ["iki ucu boklu deÄŸnek", "balÄ±k kavaÄŸa Ã§Ä±kÄ±nca", "acele iÅŸe ÅŸeytan karÄ±ÅŸÄ±r", "dereyi gÃ¶rmeden paÃ§ayÄ± sÄ±vama"] },
                { sentence: "Uzun uÄŸraÅŸ sonunda iÅŸ _____.", answer: "dÃ¶rt baÅŸÄ± mamur oldu", options: ["dÃ¶rt baÅŸÄ± mamur oldu", "taÅŸ atsan kolun yorulur", "gÃ¶zden kaÃ§mak", "nokta koymak"] },
                { sentence: "Sen burada fazla kalma, _____.", answer: "nokta koy", options: ["nokta koy", "ayaÄŸÄ±nÄ± yorganÄ±na gÃ¶re uzat", "sÄ±rtÄ± sÄ±vazlanmak", "gÃ¶ze girmek"] },
                { sentence: "PlanlarÄ± kaÄŸÄ±t Ã¼zerinde _____, sonra uygulamaya geÃ§.", answer: "kafasÄ± taÅŸa Ã§arpsÄ±n", options: ["kafasÄ± taÅŸa Ã§arpsÄ±n", "topu taÅŸa vurmak", "balÄ±k kavaÄŸa Ã§Ä±kÄ±nca", "iÅŸin iÃ§inden Ã§Ä±kmak"] }
            ],
            zone4: [
                { idiom: "Damlaya damlaya gÃ¶l olur", options: ["Birikimin zamanla artmasÄ±", "Aniden zengin olmak", "Tarifsiz haz almak", "HiÃ§bir ÅŸey yapmamak"], answer: 0 },
                { idiom: "GÃ¶zden Ä±rak olan gÃ¶nÃ¼lden de Ä±rak olur", options: ["UzaklaÅŸanÄ±n unutulmasÄ±", "YakÄ±n iliÅŸki kurmak", "GÃ¶z hastalÄ±ÄŸÄ±", "Kalp hastalÄ±ÄŸÄ±"], answer: 0 },
                { idiom: "AteÅŸ olmayan yerden duman Ã§Ä±kmaz", options: ["YangÄ±n Ã§Ä±karmak", "Nedeni olmayan olay olmaz", "Sigara iÃ§mek", "Hava kirliliÄŸi"], answer: 1 },
                { idiom: "Bir koltukta iki karpuz taÅŸÄ±nmaz", options: ["Meyve satÄ±ÅŸÄ±", "AynÄ± anda iki zor iÅŸ yapÄ±lamaz", "Koltuk alÄ±ÅŸveriÅŸi", "Ev taÅŸÄ±macÄ±lÄ±ÄŸÄ±"], answer: 1 },
                { idiom: "Deveden bÃ¼yÃ¼k fil olur", options: ["Hayvan boyutlarÄ±", "Sorun bÃ¼yÃ¼r", "Zooloji bilgisi", "Afrika hayvanlarÄ±"], answer: 1 },
                { idiom: "GÃ¼lÃ¼ seven dikenine katlanÄ±r", options: ["BahÃ§Ä±vanlÄ±k", "SevdiÄŸin ÅŸeye tahammÃ¼l etmek gerekir", "Ã‡iÃ§ek yetiÅŸtirme", "DoÄŸa sevgisi"], answer: 1 },
                { idiom: "AbanÄ±n kadri yaÄŸmurda bilinir", options: ["Hava durumu", "Zor zamanda gerÃ§ek deÄŸer anlaÅŸÄ±lÄ±r", "Elbise seÃ§imi", "Meteoroloji"], answer: 1 },
                { idiom: "Etekleri zil Ã§almak", options: ["MÃ¼zik yapmak", "Ã‡ok sevinmek", "Dans etmek", "Giyim kuÅŸam"], answer: 1 },
                { idiom: "AtÄ± alan ÃœskÃ¼dar'Ä± geÃ§er", options: ["AtlÄ± spor", "FÄ±rsatÄ± kaÃ§Ä±rmak", "Ä°stanbul turu", "UlaÅŸÄ±m sorunu"], answer: 1 },
                { idiom: "Kervan yolda dÃ¼zÃ¼lÃ¼r", options: ["Deve kervanÄ±", "Ä°ÅŸler sÃ¼reÃ§te yoluna girer", "Yol yapÄ±mÄ±", "Seyahat planÄ±"], answer: 1 },
                { idiom: "SÃ¶z gÃ¼mÃ¼ÅŸse sÃ¼kÃ»t altÄ±ndÄ±r", options: ["Maden ticareti", "KonuÅŸmamak bazen daha deÄŸerlidir", "Kuyumculuk", "Para kazanma"], answer: 1 },
                { idiom: "EÅŸeÄŸini saÄŸlam kazÄ±ÄŸa baÄŸlamak", options: ["Hayvan bakÄ±mÄ±", "Ã–nlem almak", "Ã‡iftlik iÅŸleri", "KazÄ±k Ã§akma"], answer: 1 },
                { idiom: "Bir taÅŸla iki kuÅŸ vurmak", options: ["AvcÄ±lÄ±k", "Ä°ki iÅŸi birden halletmek", "TaÅŸ atma", "KuÅŸ besleme"], answer: 1 },
                { idiom: "Davulun sesi uzaktan hoÅŸ gelir", options: ["MÃ¼zik dinleme", "BaÅŸkalarÄ±nÄ±n iÅŸi kolay gÃ¶rÃ¼nÃ¼r", "Ses teknolojisi", "Davul Ã§alma"], answer: 1 },
                { idiom: "Armut dibine dÃ¼ÅŸer", options: ["Meyve hasadÄ±", "YeteneÄŸin genellikle aileden gelir", "BahÃ§e iÅŸleri", "AÄŸaÃ§ dikme"], answer: 1 },
                { idiom: "Ä°ki cambaz bir ipte oynamaz", options: ["Sirk gÃ¶sterisi", "AynÄ± iÅŸi iki kiÅŸinin paylaÅŸmasÄ± zor", "Spor mÃ¼sabakasÄ±", "Akrobasi"], answer: 1 },
                { idiom: "Sabreden derviÅŸ muradÄ±na ermiÅŸ", options: ["DinÃ® tÃ¶renler", "SabÄ±rlÄ± olan kazanÄ±r", "ManastÄ±r yaÅŸamÄ±", "Dini Ã¶ÄŸreti"], answer: 1 },
                { idiom: "Sinekten yaÄŸ Ã§Ä±karmak", options: ["BÃ¶cek bilimi", "Ä°mkansÄ±zÄ± baÅŸarmaya Ã§alÄ±ÅŸmak", "YaÄŸ Ã¼retimi", "HaÅŸere kontrolÃ¼"], answer: 1 },
                { idiom: "BalÄ±k kavaÄŸa Ã§Ä±kÄ±nca", options: ["BalÄ±k tutma", "OlasÄ± olmayan durum", "AÄŸaÃ§ tÄ±rmanma", "Nehir kenarÄ±"], answer: 1 },
                { idiom: "AyÄ±psÄ±z dost arayan dostsuz kalÄ±r", options: ["ArkadaÅŸlÄ±k", "MÃ¼kemmel arkadaÅŸ bulunamaz", "Sosyal hayat", "Ä°nsan iliÅŸkileri"], answer: 1 }
            ],
            zone5: [
                {
                    title: "Ofis Teslim Tarihi Krizi",
                    description: "Proje teslim tarihi geÃ§mek Ã¼zere ve ekip stresli.",
                    question: "Ekip arkadaÅŸlarÄ±nÄ± motive etmek iÃ§in ne sÃ¶ylemelisin?",
                    options: [
                        { text: "Damlaya damlaya gÃ¶l olur, adÄ±m adÄ±m ilerleyelim.", correct: true },
                        { text: "GÃ¶zden Ä±rak olan gÃ¶nÃ¼lden de Ä±rak olur.", correct: false },
                        { text: "BalÄ±k kavaÄŸa Ã§Ä±kÄ±nca bitecek bu iÅŸ.", correct: false },
                        { text: "Armut dibine dÃ¼ÅŸer.", correct: false }
                    ]
                },
                {
                    title: "Yeni MÃ¼ÅŸteri ToplantÄ±sÄ±",
                    description: "Ä°lk kez bÃ¼yÃ¼k bir mÃ¼ÅŸteriyle toplantÄ±ya gireceksin.",
                    question: "Kendini nasÄ±l hazÄ±rlamalÄ±sÄ±n?",
                    options: [
                        { text: "EÅŸeÄŸini saÄŸlam kazÄ±ÄŸa baÄŸla, iyi hazÄ±rlan.", correct: true },
                        { text: "GÃ¼lÃ¼ seven dikenine katlanÄ±r.", correct: false },
                        { text: "Kervan yolda dÃ¼zÃ¼lÃ¼r, hallederiz.", correct: false },
                        { text: "Bir taÅŸla iki kuÅŸ vur.", correct: false }
                    ]
                },
                {
                    title: "Beklenmedik Masraf",
                    description: "Araban tamiri beklediÄŸinden Ã§ok pahalÄ± Ã§Ä±ktÄ±.",
                    question: "Durumu nasÄ±l karÅŸÄ±larsÄ±n?",
                    options: [
                        { text: "Bu tamir iki ucu boklu deÄŸnek.", correct: false },
                        { text: "AbanÄ±n kadri yaÄŸmurda bilinir.", correct: false },
                        { text: "AyaÄŸÄ±mÄ± yorganÄ±ma gÃ¶re uzatmalÄ±ydÄ±m.", correct: true },
                        { text: "GÃ¶zden kaÃ§an inci oldu.", correct: false }
                    ]
                },
                {
                    title: "ArkadaÅŸ SÄ±rrÄ± Ä°kilemi",
                    description: "ArkadaÅŸÄ±n sana Ã¶nemli bir sÄ±r verdi, baÅŸkalarÄ± merak ediyor.",
                    question: "NasÄ±l davranmalÄ±sÄ±n?",
                    options: [
                        { text: "Sinekten yaÄŸ Ã§Ä±karmaya Ã§alÄ±ÅŸÄ±yorlar.", correct: false },
                        { text: "SÃ¶z gÃ¼mÃ¼ÅŸse sÃ¼kÃ»t altÄ±ndÄ±r.", correct: true },
                        { text: "SÄ±rtÄ± sÄ±vazlanacak iÅŸ deÄŸil.", correct: false },
                        { text: "Dereyi gÃ¶rmeden paÃ§ayÄ± sÄ±vama.", correct: false }
                    ]
                },
                {
                    title: "Kariyer DeÄŸiÅŸikliÄŸi KararÄ±",
                    description: "Yeni iÅŸ teklifi aldÄ±n ama mevcut iÅŸini bÄ±rakmak riskli.",
                    question: "KararÄ±nÄ± nasÄ±l vermelisin?",
                    options: [
                        { text: "TaÅŸÄ± gediÄŸine koymak lazÄ±m.", correct: false },
                        { text: "GÃ¼lÃ¼ seven dikenine katlanÄ±r.", correct: true },
                        { text: "Kervan yolda dÃ¼zÃ¼lÃ¼r.", correct: false },
                        { text: "BalÄ±k kavaÄŸa Ã§Ä±kÄ±nca dÃ¼ÅŸÃ¼nÃ¼rÃ¼m.", correct: false }
                    ]
                },
                {
                    title: "Sosyal Medya BaÄŸÄ±mlÄ±lÄ±ÄŸÄ±",
                    description: "ArkadaÅŸÄ±n sÃ¼rekli telefonuna bakÄ±yor, gerÃ§ek hayatÄ± kaÃ§Ä±rÄ±yor.",
                    question: "Ona ne demelisin?",
                    options: [
                        { text: "GÃ¶zden Ä±rak olan gÃ¶nÃ¼lden de Ä±rak olur.", correct: true },
                        { text: "Eteklerin zil Ã§alÄ±yor galiba.", correct: false },
                        { text: "Acele iÅŸe ÅŸeytan karÄ±ÅŸÄ±r.", correct: false },
                        { text: "Nokta koy artÄ±k.", correct: false }
                    ]
                },
                {
                    title: "Tatil PlanlamasÄ±",
                    description: "Tatil yapmak istiyorsun ama bÃ¼tÃ§en kÄ±sÄ±tlÄ±.",
                    question: "NasÄ±l bir yaklaÅŸÄ±m sergilemelisin?",
                    options: [
                        { text: "AyaÄŸÄ±mÄ± yorganÄ±ma gÃ¶re uzatmalÄ±yÄ±m.", correct: true },
                        { text: "AtÄ± alan ÃœskÃ¼dar'Ä± geÃ§er.", correct: false },
                        { text: "BalÄ±k kavaÄŸa Ã§Ä±kÄ±nca giderim.", correct: false },
                        { text: "Davulun sesi uzaktan hoÅŸ gelir.", correct: false }
                    ]
                },
                {
                    title: "Sunum Ã–ncesi Heyecan",
                    description: "BÃ¼yÃ¼k bir grup Ã¶nÃ¼nde sunum yapacaksÄ±n, Ã§ok heyecanlÄ±sÄ±n.",
                    question: "Kendini nasÄ±l sakinleÅŸtirirsin?",
                    options: [
                        { text: "Ä°ki ucu boklu deÄŸnek bu durum.", correct: false },
                        { text: "Sabreden derviÅŸ muradÄ±na ermiÅŸ.", correct: true },
                        { text: "Bir koltukta iki karpuz taÅŸÄ±nmaz.", correct: false },
                        { text: "Deveden bÃ¼yÃ¼k fil olacak.", correct: false }
                    ]
                }
            ]
        };

        // Initialize game
        function initGame() {
            updateDisplay();
        }

        function updateDisplay() {
            document.getElementById('totalScore').textContent = gameData.totalScore;
            document.getElementById('overallProgress').style.width = `${Math.min(gameData.totalScore / 600 * 100, 100)}%`;
            
            // Update zone scores
            for (let i = 0; i < 5; i++) {
                document.getElementById(`zone${i+1}Score`).textContent = `Puan: ${gameData.bestScores[i]}`;
            }
            
            // Update zone locks
            for (let i = 0; i < 5; i++) {
                const zoneCard = document.querySelector(`[data-zone="${i+1}"]`);
                const button = zoneCard.querySelector('button');
                
                if (gameData.unlockedZones[i]) {
                    zoneCard.classList.remove('zone-locked');
                    zoneCard.querySelectorAll('h3, p, span').forEach(el => {
                        el.classList.remove('text-gray-400');
                        if (el.tagName === 'H3') el.classList.add('text-blue-600');
                        else el.classList.add('text-gray-600');
                    });
                    button.className = 'bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-full font-semibold transition-colors';
                    button.textContent = gameData.bestScores[i] > 0 ? 'Tekrar Oyna' : 'Maceraya BaÅŸla';
                    button.onclick = () => startZone(i + 1);
                }
            }
            
            // Update rank
            updatePlayerRank();
        }

        function updatePlayerRank() {
            const rankElement = document.getElementById('playerRank');
            if (gameData.totalScore >= 500) {
                rankElement.textContent = 'Deyim Åampiyonu ğŸ†';
            } else if (gameData.totalScore >= 400) {
                rankElement.textContent = 'AkÄ±cÄ± KaÅŸif ğŸ§­';
            } else {
                rankElement.textContent = 'Pratik Yapmaya Devam ğŸ’¡';
            }
        }

        function startZone(zoneNum) {
            gameData.currentZone = zoneNum;
            gameData.currentQuestion = 0;
            
            document.getElementById('mainMenu').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            // Hide all game zones
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`zone${i}Game`).classList.add('hidden');
            }
            
            // Show current zone
            document.getElementById(`zone${zoneNum}Game`).classList.remove('hidden');
            
            // Set zone title and description
            const zoneInfo = {
                1: { title: 'ğŸ–ï¸ Match-Up Bay', desc: 'Deyimleri anlamlarÄ±yla eÅŸleÅŸtir' },
                2: { title: 'â›°ï¸ Bluff Cliffs', desc: 'DoÄŸru veya yanlÄ±ÅŸ sorularÄ±' },
                3: { title: 'ğŸ’ Treasure Trove', desc: 'BoÅŸluklarÄ± doldur' },
                4: { title: 'âš¡ Lightning Lagoon', desc: 'HÄ±zlÄ± quiz' },
                5: { title: 'ğŸŒ€ The Idiom Maze', desc: 'Senaryo maceralarÄ±' }
            };
            
            document.getElementById('zoneTitle').textContent = zoneInfo[zoneNum].title;
            document.getElementById('zoneDescription').textContent = zoneInfo[zoneNum].desc;
            document.getElementById('currentScore').textContent = '0';
            
            // Initialize specific zone
            switch(zoneNum) {
                case 1: initZone1(); break;
                case 2: initZone2(); break;
                case 3: initZone3(); break;
                case 4: initZone4(); break;
                case 5: initZone5(); break;
            }
        }

        // Zone 1: Match-Up Bay
        function initZone1() {
            const idioms = [...idiomsData.zone1];
            const meanings = [...idiomsData.zone1.map(item => item.meaning)];
            
            // Shuffle meanings
            for (let i = meanings.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [meanings[i], meanings[j]] = [meanings[j], meanings[i]];
            }
            
            gameData.gameState = { idioms, meanings, matches: {} };
            
            renderMatchingGame();
        }

        function renderMatchingGame() {
            const idiomsColumn = document.getElementById('idiomsColumn');
            const meaningsColumn = document.getElementById('meaningsColumn');
            
            idiomsColumn.innerHTML = '';
            meaningsColumn.innerHTML = '';
            
            gameData.gameState.idioms.forEach((item, index) => {
                const idiomDiv = document.createElement('div');
                idiomDiv.className = 'drag-item bg-blue-100 border-2 border-blue-300 rounded-lg p-3 text-center font-semibold cursor-grab';
                idiomDiv.draggable = true;
                idiomDiv.textContent = item.idiom;
                idiomDiv.dataset.idiom = item.idiom;
                idiomDiv.addEventListener('dragstart', handleDragStart);
                idiomsColumn.appendChild(idiomDiv);
            });
            
            gameData.gameState.meanings.forEach((meaning, index) => {
                const meaningDiv = document.createElement('div');
                meaningDiv.className = 'drop-zone bg-gray-50 border-2 border-gray-300 rounded-lg p-3 text-center min-h-[60px] flex items-center justify-center';
                meaningDiv.dataset.meaning = meaning;
                meaningDiv.textContent = meaning;
                meaningDiv.addEventListener('dragover', handleDragOver);
                meaningDiv.addEventListener('drop', handleDrop);
                meaningsColumn.appendChild(meaningDiv);
            });
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.idiom);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.target.classList.add('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.target.classList.remove('drag-over');
            
            const idiom = e.dataTransfer.getData('text/plain');
            const meaning = e.target.dataset.meaning;
            
            gameData.gameState.matches[idiom] = meaning;
            
            // Visual feedback
            e.target.innerHTML = `<div class="font-semibold text-blue-600">${idiom}</div><div class="text-sm text-gray-600">${meaning}</div>`;
            e.target.classList.add('bg-blue-50', 'border-blue-400');
            
            // Hide the dragged item
            const draggedItem = document.querySelector(`[data-idiom="${idiom}"]`);
            if (draggedItem) draggedItem.style.opacity = '0.3';
            
            updateMatchProgress();
        }

        function updateMatchProgress() {
            const matchCount = Object.keys(gameData.gameState.matches).length;
            document.getElementById('matchProgress').textContent = `${matchCount}/10`;
            document.getElementById('matchProgressBar').style.width = `${matchCount * 10}%`;
        }

        function checkMatches() {
            let correctMatches = 0;
            const matches = gameData.gameState.matches;
            
            gameData.gameState.idioms.forEach(item => {
                const dropZone = document.querySelector(`[data-meaning="${matches[item.idiom]}"]`);
                if (matches[item.idiom] === item.meaning) {
                    correctMatches++;
                    if (dropZone) dropZone.classList.add('correct-match');
                } else if (matches[item.idiom]) {
                    if (dropZone) dropZone.classList.add('wrong-match');
                }
            });
            
            const score = correctMatches * 10;
            
            // Update scores only if this is better than previous best
            if (score > gameData.bestScores[0]) {
                const scoreDiff = score - gameData.bestScores[0];
                gameData.totalScore += scoreDiff;
                gameData.bestScores[0] = score;
            }
            
            // Check if zone 2 should be unlocked (80% accuracy)
            if (correctMatches >= 8) {
                gameData.unlockedZones[1] = true;
            }
            
            showResults(1, score, correctMatches, 10);
        }

        // Zone 2: True/False
        function initZone2() {
            gameData.gameState = {
                questions: [...idiomsData.zone2],
                currentQ: 0,
                score: 0,
                lives: 3,
                correctAnswers: 0
            };
            
            showTrueFalseQuestion();
        }

        function showTrueFalseQuestion() {
            const state = gameData.gameState;
            const question = state.questions[state.currentQ];
            
            document.getElementById('tfQuestionNum').textContent = state.currentQ + 1;
            document.getElementById('livesCount').textContent = state.lives;
            document.getElementById('tfIdiom').textContent = question.idiom;
            document.getElementById('tfDefinition').textContent = question.meaning;
            document.getElementById('tfProgressBar').style.width = `${(state.currentQ + 1) * 10}%`;
        }

        function answerTrueFalse(userAnswer) {
            const state = gameData.gameState;
            const question = state.questions[state.currentQ];
            const correct = userAnswer === question.correct;
            
            if (correct) {
                state.score += 5;
                state.correctAnswers++;
                document.getElementById('currentScore').textContent = state.score;
            } else {
                state.lives--;
                state.score = Math.max(0, state.score - 2);
                document.getElementById('currentScore').textContent = state.score;
                
                if (state.lives <= 0) {
                    // Reset to start of zone
                    state.currentQ = 0;
                    state.lives = 3;
                    state.score = 0;
                    showTrueFalseQuestion();
                    return;
                }
            }
            
            state.currentQ++;
            
            if (state.currentQ >= state.questions.length) {
                // Zone complete - update best score only if improved
                if (state.score > gameData.bestScores[1]) {
                    const scoreDiff = state.score - gameData.bestScores[1];
                    gameData.totalScore += scoreDiff;
                    gameData.bestScores[1] = state.score;
                }
                gameData.unlockedZones[2] = true; // Unlock zone 3
                showResults(2, state.score, state.correctAnswers, state.questions.length);
            } else {
                setTimeout(showTrueFalseQuestion, 1000);
            }
        }

        // Zone 3: Fill in the Blank
        function initZone3() {
            gameData.gameState = {
                questions: [...idiomsData.zone3],
                currentQ: 0,
                score: 0,
                correctAnswers: 0
            };
            
            showFillBlankQuestion();
        }

        function showFillBlankQuestion() {
            const state = gameData.gameState;
            const question = state.questions[state.currentQ];
            
            document.getElementById('fibQuestionNum').textContent = state.currentQ + 1;
            document.getElementById('fibSentence').textContent = question.sentence;
            document.getElementById('fibProgressBar').style.width = `${(state.currentQ + 1) * 10}%`;
            
            // Populate select options
            const select = document.getElementById('fibSelect');
            select.innerHTML = '<option value="">Bir deyim seÃ§in...</option>';
            question.options.forEach(option => {
                const optionEl = document.createElement('option');
                optionEl.value = option;
                optionEl.textContent = option;
                select.appendChild(optionEl);
            });
            
            // Clear bonus textarea
            document.getElementById('bonusSentence').value = '';
        }

        function submitFillBlank() {
            const state = gameData.gameState;
            const question = state.questions[state.currentQ];
            const userAnswer = document.getElementById('fibSelect').value;
            
            if (!userAnswer) {
                alert('LÃ¼tfen Ã¶nce bir deyim seÃ§in!');
                return;
            }
            
            const correct = userAnswer === question.answer;
            
            if (correct) {
                state.score += 15;
                state.correctAnswers++;
                document.getElementById('currentScore').textContent = state.score;
            }
            
            // Move to next question or finish
            state.currentQ++;
            
            if (state.currentQ >= state.questions.length) {
                // Update best score only if improved
                if (state.score > gameData.bestScores[2]) {
                    const scoreDiff = state.score - gameData.bestScores[2];
                    gameData.totalScore += scoreDiff;
                    gameData.bestScores[2] = state.score;
                }
                gameData.unlockedZones[3] = true; // Unlock zone 4
                showResults(3, state.score, state.correctAnswers, state.questions.length);
            } else {
                setTimeout(showFillBlankQuestion, 1000);
            }
        }

        function submitBonus() {
            const bonusText = document.getElementById('bonusSentence').value.trim();
            if (bonusText.length > 10) { // Simple validation
                gameData.gameState.score += 5;
                document.getElementById('currentScore').textContent = gameData.gameState.score;
                alert('Bonus puan kazandÄ±nÄ±z! +5 puan');
                document.getElementById('bonusSentence').value = '';
            } else {
                alert('Bonus puan kazanmak iÃ§in daha uzun bir cÃ¼mle yazÄ±n!');
            }
        }

        // Zone 4: Lightning Round
        function initZone4() {
            gameData.gameState = {
                questions: [...idiomsData.zone4],
                currentQ: 0,
                score: 0,
                timeLeft: 60,
                correctAnswers: 0,
                timer: null
            };
            
            startLightningTimer();
            showLightningQuestion();
        }

        function startLightningTimer() {
            const state = gameData.gameState;
            document.getElementById('timerDisplay').classList.remove('hidden');
            
            state.timer = setInterval(() => {
                state.timeLeft--;
                const timerEl = document.getElementById('lrTimer');
                timerEl.textContent = state.timeLeft;
                
                if (state.timeLeft <= 10) {
                    timerEl.classList.add('timer-warning');
                }
                
                if (state.timeLeft <= 0) {
                    clearInterval(state.timer);
                    finishLightningRound();
                }
            }, 1000);
        }

        function showLightningQuestion() {
            const state = gameData.gameState;
            const question = state.questions[state.currentQ];
            
            document.getElementById('lrQuestionNum').textContent = state.currentQ + 1;
            document.getElementById('lrIdiom').textContent = question.idiom;
            document.getElementById('lrProgressBar').style.width = `${(state.currentQ + 1) * 5}%`;
            
            const optionsContainer = document.getElementById('lrOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'bg-yellow-100 hover:bg-yellow-200 border-2 border-yellow-300 rounded-lg p-4 font-semibold transition-colors';
                button.textContent = option;
                button.onclick = () => answerLightning(index);
                optionsContainer.appendChild(button);
            });
        }

        function answerLightning(selectedIndex) {
            const state = gameData.gameState;
            const question = state.questions[state.currentQ];
            const correct = selectedIndex === question.answer;
            
            if (correct) {
                state.score += 5 + state.timeLeft; // Base points + time bonus
                state.correctAnswers++;
                document.getElementById('currentScore').textContent = state.score;
            }
            
            state.currentQ++;
            
            if (state.currentQ >= state.questions.length || state.timeLeft <= 0) {
                finishLightningRound();
            } else {
                showLightningQuestion();
            }
        }

        function finishLightningRound() {
            const state = gameData.gameState;
            clearInterval(state.timer);
            document.getElementById('timerDisplay').classList.add('hidden');
            
            // Update best score only if improved
            if (state.score > gameData.bestScores[3]) {
                const scoreDiff = state.score - gameData.bestScores[3];
                gameData.totalScore += scoreDiff;
                gameData.bestScores[3] = state.score;
            }
            gameData.unlockedZones[4] = true; // Unlock final zone
            showResults(4, state.score, state.correctAnswers, Math.min(state.questions.length, 20));
        }

        // Zone 5: Scenario Game
        function initZone5() {
            gameData.gameState = {
                scenarios: [...idiomsData.zone5],
                currentS: 0,
                score: 0,
                correctAnswers: 0
            };
            
            showScenario();
        }

        function showScenario() {
            const state = gameData.gameState;
            const scenario = state.scenarios[state.currentS];
            
            document.getElementById('scenarioNum').textContent = state.currentS + 1;
            document.getElementById('scenarioTitle').textContent = scenario.title;
            document.getElementById('scenarioDescription').textContent = scenario.description;
            document.getElementById('scenarioQuestion').textContent = scenario.question;
            document.getElementById('scenarioProgressBar').style.width = `${(state.currentS + 1) * 12.5}%`;
            
            const optionsContainer = document.getElementById('scenarioOptions');
            optionsContainer.innerHTML = '';
            
            scenario.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'bg-purple-100 hover:bg-purple-200 border-2 border-purple-300 rounded-lg p-4 text-left transition-colors w-full';
                button.innerHTML = `<div class="font-semibold">${option.text}</div>`;
                button.onclick = () => answerScenario(index);
                optionsContainer.appendChild(button);
            });
        }

        function answerScenario(selectedIndex) {
            const state = gameData.gameState;
            const scenario = state.scenarios[state.currentS];
            const correct = scenario.options[selectedIndex].correct;
            
            if (correct) {
                state.score += 20;
                state.correctAnswers++;
                document.getElementById('currentScore').textContent = state.score;
            }
            
            state.currentS++;
            
            if (state.currentS >= state.scenarios.length) {
                // Update best score only if improved
                if (state.score > gameData.bestScores[4]) {
                    const scoreDiff = state.score - gameData.bestScores[4];
                    gameData.totalScore += scoreDiff;
                    gameData.bestScores[4] = state.score;
                }
                showResults(5, state.score, state.correctAnswers, state.scenarios.length);
            } else {
                setTimeout(showScenario, 1500);
            }
        }

        // Results and Navigation
        function showResults(zone, score, correct, total) {
            const modal = document.getElementById('resultsModal');
            const icon = document.getElementById('resultsIcon');
            const title = document.getElementById('resultsTitle');
            const message = document.getElementById('resultsMessage');
            const scoreDisplay = document.getElementById('resultsScore');
            
            const percentage = Math.round((correct / total) * 100);
            
            if (percentage >= 80) {
                icon.textContent = 'ğŸ‰';
                title.textContent = 'MÃ¼kemmel Ä°ÅŸ!';
                message.textContent = `Bu bÃ¶lÃ¼mÃ¼ %${percentage} doÄŸrulukla tamamladÄ±nÄ±z!`;
            } else if (percentage >= 60) {
                icon.textContent = 'ğŸ‘';
                title.textContent = 'Ä°yi Ä°ÅŸ!';
                message.textContent = `%${percentage} doÄŸru cevap verdiniz. Pratik yapmaya devam!`;
            } else {
                icon.textContent = 'ğŸ’ª';
                title.textContent = 'Denemeye Devam!';
                message.textContent = `%${percentage} doÄŸru cevap verdiniz. Pratik mÃ¼kemmelleÅŸtirir!`;
            }
            
            scoreDisplay.textContent = `${score} puan`;
            modal.classList.remove('hidden');
        }

        function closeResults() {
            document.getElementById('resultsModal').classList.add('hidden');
            returnToMenu();
        }

        function returnToMenu() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('mainMenu').classList.remove('hidden');
            updateDisplay();
        }

        // Initialize the game when page loads
        initGame();
    </script>
</body>
</html>
