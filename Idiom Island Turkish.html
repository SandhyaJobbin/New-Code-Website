<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Deyim AdasÄ± MacerasÄ±</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Inter:wght@400;500;600;700&display=swap');
    .game-font { font-family: 'Fredoka One', cursive; }
    .body-font { font-family: 'Inter', sans-serif; }
    .island-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    .zone-card { transition: all 0.3s ease; }
    .zone-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
    .zone-locked { opacity: 0.6; filter: grayscale(100%); }
    .progress-bar { transition: width 0.5s ease; }
    .drag-item { cursor: grab; transition: all 0.2s ease; }
    .drag-item:hover { transform: scale(1.05); }
    .drop-zone { min-height: 60px; transition: all 0.2s ease; }
    .drop-zone.drag-over { background-color: #e0f2fe; border-color: #0284c7; }
    .correct-match { background-color: #dcfce7 !important; border-color: #16a34a !important; }
    .wrong-match   { background-color: #fef2f2 !important; border-color: #dc2626 !important; }

    @keyframes bounce {
      0%,20%,50%,80%,100% { transform: translateY(0); }
      40% { transform: translateY(-10px); }
      60% { transform: translateY(-5px); }
    }
    .timer-warning { animation: pulse 1s infinite; }
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }
  </style>
</head>
<body class="island-bg body-font">
  <div id="app" class="min-h-screen">
    <div id="mainMenu" class="container mx-auto px-4 py-8">
      <div class="text-center mb-12">
        <h1 class="game-font text-6xl text-white mb-4">ğŸï¸ Deyim AdasÄ± MacerasÄ±</h1>
        <p class="text-xl text-blue-100 mb-8">EÄŸlenceli meydan okumalarla 100 deyimde ustalaÅŸÄ±n!</p>
        <div class="bg-white/20 backdrop-blur-sm rounded-2xl p-6 max-w-md mx-auto mb-8">
          <div class="flex justify-between items-center mb-4">
            <span class="text-white font-semibold">Toplam Puan:</span>
            <span id="totalScore" class="text-2xl font-bold text-yellow-300">0</span>
          </div>
          <div class="w-full bg-white/20 rounded-full h-3">
            <div id="overallProgress" class="progress-bar bg-gradient-to-r from-yellow-400 to-orange-500 h-3 rounded-full" style="width: 0%"></div>
          </div>
          <p class="text-blue-100 text-sm mt-2">UstalÄ±ÄŸa Giden Yol</p>
        </div>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-6xl mx-auto">
        <div class="zone-card bg-white rounded-2xl p-6 shadow-xl" data-zone="1">
          <div class="text-center">
            <div class="text-4xl mb-4">ğŸ–ï¸</div>
            <h3 class="game-font text-2xl text-blue-600 mb-2">EÅŸleÅŸtirme Koyu</h3>
            <p class="text-gray-600 mb-4">Deyimleri anlamlarÄ±yla eÅŸleÅŸtirin</p>
            <div class="flex justify-between text-sm text-gray-500 mb-4">
              <span>Maks: 100</span>
              <span id="zone1Score">Puan: 0</span>
            </div>
            <button onclick="startZone(1)" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-full font-semibold">
              BaÅŸla
            </button>
          </div>
        </div>
        <div class="zone-card bg-white rounded-2xl p-6 shadow-xl zone-locked" data-zone="2">
          <div class="text-center">
            <div class="text-4xl mb-4">â›°ï¸</div>
            <h3 class="game-font text-2xl text-gray-400 mb-2">DoÄŸru/YanlÄ±ÅŸ UÃ§urumu</h3>
            <p class="text-gray-400 mb-4">DoÄŸru veya YanlÄ±ÅŸ</p>
            <div class="flex justify-between text-sm text-gray-400 mb-4">
              <span>Maks: 100</span>
              <span id="zone2Score">Puan: 0</span>
            </div>
            <button class="bg-gray-300 text-gray-500 px-6 py-2 rounded-full cursor-not-allowed">
              ğŸ”’ Kilitli
            </button>
          </div>
        </div>
        <div class="zone-card bg-white rounded-2xl p-6 shadow-xl zone-locked" data-zone="3">
          <div class="text-center">
            <div class="text-4xl mb-4">ğŸ’</div>
            <h3 class="game-font text-2xl text-gray-400 mb-2">Deyim Hazinesi</h3>
            <p class="text-gray-400 mb-4">BoÅŸluklarÄ± doldurun</p>
            <div class="flex justify-between text-sm text-gray-400 mb-4">
              <span>Maks: 150</span>
              <span id="zone3Score">Puan: 0</span>
            </div>
            <button class="bg-gray-300 text-gray-500 px-6 py-2 rounded-full cursor-not-allowed">
              ğŸ”’ Kilitli
            </button>
          </div>
        </div>
        <div class="zone-card bg-white rounded-2xl p-6 shadow-xl zone-locked" data-zone="4">
          <div class="text-center">
            <div class="text-4xl mb-4">âš¡</div>
            <h3 class="game-font text-2xl text-gray-400 mb-2">ÅimÅŸek LagÃ¼nÃ¼</h3>
            <p class="text-gray-400 mb-4">HÄ±zlÄ± Test</p>
            <div class="flex justify-between text-sm text-gray-400 mb-4">
              <span>Maks: 100</span>
              <span id="zone4Score">Puan: 0</span>
            </div>
            <button class="bg-gray-300 text-gray-500 px-6 py-2 rounded-full cursor-not-allowed">
                ğŸ”’ Kilitli
            </button>
          </div>
        </div>
        <div class="zone-card bg-white rounded-2xl p-6 shadow-xl zone-locked" data-zone="5">
          <div class="text-center">
            <div class="text-4xl mb-4">ğŸŒ€</div>
            <h3 class="game-font text-2xl text-gray-400 mb-2">Senaryo Labirenti</h3>
            <p class="text-gray-400 mb-4">Ä°nteraktif senaryolar</p>
            <div class="flex justify-between text-sm text-gray-400 mb-4">
              <span>Maks: 150</span>
              <span id="zone5Score">Puan: 0</span>
            </div>
            <button class="bg-gray-300 text-gray-500 px-6 py-2 rounded-full cursor-not-allowed">
              ğŸ”’ Kilitli
            </button>
          </div>
        </div>
        <div class="zone-card bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-6 shadow-xl">
          <div class="text-center text-white">
            <div class="text-4xl mb-4">ğŸ†</div>
            <h3 class="game-font text-2xl mb-2">Seviyeniz</h3>
            <p id="playerRank" class="text-lg font-semibold mb-2">Pratik Yapmaya Devam Et</p>
            <div class="text-sm opacity-90">
              <div>ğŸ† 500+ puan: Åampiyon</div>
              <div>ğŸ§­ 400+ puan: KaÅŸif</div>
              <div>ğŸ’¡ 0+ puan: Acemi</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="gameScreen" class="hidden container mx-auto px-4 py-8">
      <div class="bg-white/20 backdrop-blur-sm rounded-2xl p-4 mb-6">
        <div class="flex justify-between items-center">
          <button onclick="returnToMenu()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg">
            â† Adaya Geri DÃ¶n
          </button>
          <div class="text-center">
            <h2 id="zoneTitle" class="game-font text-2xl text-white"></h2>
            <p id="zoneDescription" class="text-blue-100"></p>
          </div>
          <div class="text-right">
            <div class="text-white font-semibold">Puan: <span id="currentScore">0</span></div>
            <div id="timerDisplay" class="text-yellow-300 font-bold hidden"></div>
          </div>
        </div>
      </div>

      <div id="zone1Game" class="hidden">
        <div class="bg-white rounded-2xl p-6 shadow-xl">
          <div class="mb-6">
            <div class="flex justify-between items-center mb-2">
              <span class="font-semibold">Ä°lerleme</span>
              <span id="matchProgress">0/10</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
              <div id="matchProgressBar" class="progress-bar bg-blue-500 h-3 rounded-full" style="width: 0%"></div>
            </div>
          </div>
          <div class="grid md:grid-cols-2 gap-8">
            <div>
              <h3 class="font-bold text-lg mb-4 text-center">Deyimler</h3>
              <div id="idiomsColumn" class="space-y-3"></div>
            </div>
            <div>
              <h3 class="font-bold text-lg mb-4 text-center">Anlamlar</h3>
              <div id="meaningsColumn" class="space-y-3"></div>
            </div>
          </div>
          <div class="text-center mt-6">
            <button id="checkMatches" onclick="checkMatches()" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full font-semibold">
              CevaplarÄ± Kontrol Et
            </button>
          </div>
        </div>
      </div>

      <div id="zone2Game" class="hidden">
        <div class="bg-white rounded-2xl p-6 shadow-xl max-w-2xl mx-auto">
          <div class="mb-6">
            <div class="flex justify-between items-center mb-2">
              <span class="font-semibold">Soru <span id="tfQuestionNum">1</span>/10</span>
              <span class="text-red-500 font-semibold">Can: <span id="livesCount">3</span></span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
              <div id="tfProgressBar" class="progress-bar bg-purple-500 h-3 rounded-full" style="width: 10%"></div>
            </div>
          </div>
          <div class="text-center mb-8">
            <div class="bg-blue-50 rounded-xl p-6 mb-6">
              <h3 class="text-2xl font-bold text-blue-600 mb-4" id="tfIdiom"></h3>
              <p class="text-lg text-gray-700" id="tfDefinition"></p>
            </div>
            <div class="space-x-4">
              <button onclick="answerTrueFalse(true)" class="bg-green-500 hover:bg-green-600 text-white px-8 py-4 rounded-full font-bold text-xl">
                âœ“ DOÄRU
              </button>
              <button onclick="answerTrueFalse(false)" class="bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-full font-bold text-xl">
                âœ— YANLIÅ
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="zone3Game" class="hidden">
        <div class="bg-white rounded-2xl p-6 shadow-xl max-w-2xl mx-auto">
          <div class="mb-6">
            <div class="flex justify-between items-center mb-2">
              <span class="font-semibold">Soru <span id="fibQuestionNum">1</span>/5</span>
              <span class="font-semibold">Bonus mevcut! ğŸ“</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
              <div id="fibProgressBar" class="progress-bar bg-green-500 h-3 rounded-full" style="width: 20%"></div>
            </div>
          </div>
          <div class="text-center mb-8">
            <div class="bg-green-50 rounded-xl p-6 mb-6">
              <p class="text-lg text-gray-700 mb-4" id="fibSentence"></p>
              <select id="fibSelect" class="border-2 border-green-300 rounded-lg px-4 py-2 text-lg font-semibold bg-white">
                <option value="">SeÃ§iniz...</option>
              </select>
            </div>
            <button onclick="submitFillBlank()" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full font-semibold mb-4">
              Cevapla
            </button>
            <div class="border-t pt-4">
              <p class="text-sm text-gray-600 mb-2">Bonus: Kendi cÃ¼mleni kur!</p>
              <textarea id="bonusSentence" placeholder="CÃ¼mleniz..." class="w-full border-2 border-gray-300 rounded-lg p-3 text-sm"></textarea>
              <button onclick="submitBonus()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg font-semibold mt-2">
                Bonusu GÃ¶nder (+5)
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="zone4Game" class="hidden">
        <div class="bg-white rounded-2xl p-6 shadow-xl max-w-2xl mx-auto">
          <div class="mb-6">
            <div class="flex justify-between items-center mb-2">
              <span class="font-semibold">Soru <span id="lrQuestionNum">1</span>/5</span>
              <span id="lrTimer" class="text-2xl font-bold text-red-500">60</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
              <div id="lrProgressBar" class="progress-bar bg-yellow-500 h-3 rounded-full" style="width: 20%"></div>
            </div>
          </div>
          <div class="text-center mb-8">
            <div class="bg-yellow-50 rounded-xl p-6 mb-6">
              <h3 class="text-2xl font-bold text-yellow-600 mb-4" id="lrIdiom"></h3>
            </div>
            <div class="grid grid-cols-2 gap-4" id="lrOptions"></div>
          </div>
        </div>
      </div>

      <div id="zone5Game" class="hidden">
        <div class="bg-white rounded-2xl p-6 shadow-xl max-w-3xl mx-auto">
          <div class="mb-6">
            <div class="flex justify-between items-center mb-2">
              <span class="font-semibold">Senaryo <span id="scenarioNum">1</span>/2</span>
              <span class="font-semibold">Son meydan okuma! ğŸŒŸ</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
              <div id="scenarioProgressBar" class="progress-bar bg-purple-500 h-3 rounded-full" style="width: 50%"></div>
            </div>
          </div>
          <div class="mb-8">
            <div class="bg-purple-50 rounded-xl p-6 mb-6">
              <h3 class="text-xl font-bold text-purple-600 mb-4" id="scenarioTitle"></h3>
              <p class="text-gray-700 mb-4" id="scenarioDescription"></p>
              <p class="font-semibold text-gray-800" id="scenarioQuestion"></p>
            </div>
            <div class="space-y-3" id="scenarioOptions"></div>
          </div>
        </div>
      </div>
    </div>

    <div id="resultsModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
      <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center">
        <div id="resultsIcon" class="text-6xl mb-4"></div>
        <h3 id="resultsTitle" class="game-font text-2xl mb-4"></h3>
        <p id="resultsMessage" class="text-gray-600 mb-6"></p>
        <div id="resultsScore" class="text-3xl font-bold text-blue-600 mb-6"></div>
        <button onclick="closeResults()" class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-full font-semibold">
          Devam Et
        </button>
      </div>
    </div>
  </div>

  <script>
    // Core game state
    const gameData = {
      totalScore: 0,
      zoneScores: [0,0,0,0,0],
      unlockedZones: [true,false,false,false,false],
      currentZone: 0,
      currentQuestion: 0,
      gameState: {}
    };

    // Turkish idioms data
    const idiomsData = {
      zone1: [
        { idiom: "AbayÄ± yakmak", meaning: "AÅŸÄ±k olmak" },
        { idiom: "AteÅŸ pÃ¼skÃ¼rmek", meaning: "Ã‡ok sinirlenmek" },
        { idiom: "BaltayÄ± taÅŸa vurmak", meaning: "Pot kÄ±rmak, gaf yapmak" },
        { idiom: "Can kulaÄŸÄ± ile dinlemek", meaning: "Ã‡ok dikkatli dinlemek" },
        { idiom: "Etekleri zil Ã§almak", meaning: "Ã‡ok sevinmek" },
        { idiom: "HapÄ± yutmak", meaning: "KÃ¶tÃ¼ duruma dÃ¼ÅŸmek" },
        { idiom: "Ä°pe un sermek", meaning: "Bahane uydurmak" },
        { idiom: "Pabucu dama atÄ±lmak", meaning: "DeÄŸerini, Ã¶nemini yitirmek" },
        { idiom: "GÃ¶z boyamak", meaning: "KandÄ±rmak, aldatmak" },
        { idiom: "Kafa patlatmak", meaning: "Bir konu Ã¼zerinde Ã§ok dÃ¼ÅŸÃ¼nmek" }
      ],
      zone2: [
        { idiom: "Armut piÅŸ, aÄŸzÄ±ma dÃ¼ÅŸ", meaning: "HazÄ±ra konmak, emek harcamadan bir ÅŸey beklemek", correct: true },
        { idiom: "AÄŸzÄ± kulaklarÄ±na varmak", meaning: "ÃœzÃ¼lmek, kederlenmek", correct: false },
        { idiom: "BindiÄŸi dalÄ± kesmek", meaning: "Kendine zarar verecek bir iÅŸ yapmak", correct: true },
        { idiom: "Ã‡am devirmek", meaning: "Duruma uygun olmayan, kÄ±rÄ±cÄ± bir sÃ¶z sÃ¶ylemek", correct: true },
        { idiom: "DamarÄ±na basmak", meaning: "Birini Ã¶vmek, mutlu etmek", correct: false },
        { idiom: "Ä°ncir Ã§ekirdeÄŸini doldurmaz", meaning: "Ã‡ok Ã¶nemsiz bir neden", correct: true },
        { idiom: "Pireyi deve yapmak", meaning: "KÃ¼Ã§Ã¼k bir sorunu Ã§ok abartmak", correct: true },
        { idiom: "GÃ¶zden dÃ¼ÅŸmek", meaning: "Daha Ã§ok sevilmek", correct: false },
        { idiom: "Hava atmak", meaning: "GÃ¶steriÅŸ yapmak, bÃ¶bÃ¼rlenmek", correct: true },
        { idiom: "Eli kulaÄŸÄ±nda", meaning: "Bir olayÄ±n gerÃ§ekleÅŸmesi Ã§ok yakÄ±n", correct: true }
      ],
      zone3: [
        {
          sentence: "SÄ±navÄ± kazandÄ±ÄŸÄ±nÄ± duyunca _______.",
          answer: "Etekleri zil Ã§almak",
          options: ["Etekleri zil Ã§almak", "AteÅŸ pÃ¼skÃ¼rmek", "HapÄ± yutmak", "Ä°pe un sermek"]
        },
        {
          sentence: "YaptÄ±ÄŸÄ± hatadan sonra patronunun gÃ¶zÃ¼nde _______.",
          answer: "Pabucu dama atÄ±lmak",
          options: ["Pabucu dama atÄ±lmak", "Can kulaÄŸÄ± ile dinlemek", "GÃ¶z boyamak", "Kafa patlatmak"]
        },
        {
          sentence: "BoÅŸ bahanelerle iÅŸten kaÃ§ma, _______!",
          answer: "Ä°pe un sermek",
          options: ["Ä°pe un sermek", "BaltayÄ± taÅŸa vurmak", "AbayÄ± yakmak", "Etekleri zil Ã§almak"]
        },
        {
          sentence: "Bu zor problemi Ã§Ã¶zmek iÃ§in bÃ¼tÃ¼n gece _______.",
          answer: "Kafa patlatmak",
          options: ["Kafa patlatmak", "AteÅŸ pÃ¼skÃ¼rmek", "GÃ¶z boyamak", "HapÄ± yutmak"]
        },
        {
          sentence: "Yalan sÃ¶ylediÄŸi ortaya Ã§Ä±kÄ±nca fena halde _______.",
          answer: "HapÄ± yutmak",
          options: ["HapÄ± yutmak", "Can kulaÄŸÄ± ile dinlemek", "Pabucu dama atÄ±lmak", "Ä°pe un sermek"]
        }
      ],
      zone4: [
        { idiom: "AteÅŸ pÃ¼skÃ¼rmek", options: ["Ã‡ok sinirlenmek","Ã‡ok sevinmek","Ã‡ok Ã¼ÅŸÃ¼mek","Ã‡ok gÃ¼lmek"], answer: 0 },
        { idiom: "Can kulaÄŸÄ± ile dinlemek", options: ["Ä°stemeden dinlemek","GÃ¼rÃ¼ltÃ¼ yapmak","Ã‡ok dikkatli dinlemek","Uyuklamak"], answer: 2 },
        { idiom: "GÃ¶z boyamak", options: ["YardÄ±m etmek","KandÄ±rmak, aldatmak","Resim yapmak","Mutlu etmek"], answer: 1 },
        { idiom: "BaltayÄ± taÅŸa vurmak", options: ["BaÅŸarÄ±lÄ± olmak","Odun kÄ±rmak","DoÄŸruyu sÃ¶ylemek","Pot kÄ±rmak, gaf yapmak"], answer: 3 },
        { idiom: "AbayÄ± yakmak", options: ["AÅŸÄ±k olmak","KÄ±yafet giymek","IsÄ±nmak","KÄ±zmak"], answer: 0 }
      ],
      zone5: [
        {
          title: "Ã–nemsiz Sorun",
          description: "ArkadaÅŸÄ±n, Ã§ok kÃ¼Ã§Ã¼k ve Ã¶nemsiz bir sorunu sanki dÃ¼nyanÄ±n sonuymuÅŸ gibi anlatÄ±yor.",
          question: "Onun iÃ§in hangi deyimi kullanÄ±rsÄ±n?",
          options: [
            { text: "Pireyi deve yapÄ±yor.", idiom: "Pireyi deve yapmak", correct: true },
            { text: "BindiÄŸi dalÄ± kesiyor.", idiom: "BindiÄŸi dalÄ± kesmek", correct: false }
          ]
        },
        {
          title: "SÃ¼rekli GÃ¶steriÅŸ",
          description: "Bir tanÄ±dÄ±ÄŸÄ±n sÃ¼rekli yeni aldÄ±ÄŸÄ± eÅŸyalarla ve baÅŸarÄ±larÄ±yla Ã¶vÃ¼nÃ¼yor.",
          question: "Onun bu davranÄ±ÅŸÄ± iÃ§in ne dersin?",
          options: [
            { text: "SÃ¼rekli hava atÄ±yor.", idiom: "Hava atmak", correct: true },
            { text: "AÄŸzÄ± kulaklarÄ±na varÄ±yor.", idiom: "AÄŸzÄ± kulaklarÄ±na varmak", correct: false }
          ]
        }
      ]
    };

    // INITIALIZE
    function initGame() {
      updateDisplay();
    }

    function updateDisplay() {
      document.getElementById('totalScore').textContent = gameData.totalScore;
      document.getElementById('overallProgress').style.width = `${Math.min(gameData.totalScore/600*100,100)}%`;
      for (let i = 0; i < 5; i++) {
        document.getElementById(`zone${i+1}Score`).textContent = `Puan: ${gameData.zoneScores[i]}`;
        const card = document.querySelector(`[data-zone="${i+1}"]`);
        const btn = card.querySelector('button');
        const elements = card.querySelectorAll('h3, p, span');

        if (gameData.unlockedZones[i]) {
          card.classList.remove('zone-locked');
          elements.forEach(el => {
              el.classList.remove('text-gray-400');
              if (el.tagName === 'H3') el.classList.add('text-blue-600');
              else el.classList.add('text-gray-600', 'text-gray-500');
          });
          btn.textContent = gameData.zoneScores[i] > 0 ? 'Tekrar Oyna' : 'BaÅŸla';
          btn.classList.remove('cursor-not-allowed', 'bg-gray-300', 'text-gray-500');
          btn.classList.add('bg-blue-500', 'hover:bg-blue-600', 'text-white');
          btn.disabled = false;
          btn.setAttribute('onclick', `startZone(${i+1})`);
        } else {
            card.classList.add('zone-locked');
            elements.forEach(el => {
                el.classList.add('text-gray-400');
                el.classList.remove('text-blue-600', 'text-gray-600', 'text-gray-500');
            });
            btn.textContent = 'ğŸ”’ Kilitli';
            btn.classList.add('cursor-not-allowed', 'bg-gray-300', 'text-gray-500');
            btn.classList.remove('bg-blue-500', 'hover:bg-blue-600', 'text-white');
            btn.disabled = true;
            btn.removeAttribute('onclick');
        }
      }
      updatePlayerRank();
    }

    function updatePlayerRank() {
      const rankEl = document.getElementById('playerRank');
      if (gameData.totalScore >= 500) {
        rankEl.textContent = 'Åampiyon ğŸ†';
      } else if (gameData.totalScore >= 400) {
        rankEl.textContent = 'KaÅŸif ğŸ§­';
      } else {
        rankEl.textContent = 'Acemi ğŸ’¡';
      }
    }

    // START ZONE
    function startZone(zoneNum) {
      gameData.currentZone = zoneNum;
      gameData.currentQuestion = 0;
      document.getElementById('mainMenu').classList.add('hidden');
      document.getElementById('gameScreen').classList.remove('hidden');
      for (let i = 1; i <= 5; i++) {
        document.getElementById(`zone${i}Game`).classList.add('hidden');
      }
      document.getElementById(`zone${zoneNum}Game`).classList.remove('hidden');

      const zoneInfo = {
        1: { title: 'ğŸ–ï¸ EÅŸleÅŸtirme Koyu', desc: 'Deyimleri anlamlarÄ±yla eÅŸleÅŸtirin' },
        2: { title: 'â›°ï¸ DoÄŸru/YanlÄ±ÅŸ UÃ§urumu', desc: 'DoÄŸru veya YanlÄ±ÅŸ' },
        3: { title: 'ğŸ’ Deyim Hazinesi', desc: 'CÃ¼mlelerdeki boÅŸluklarÄ± doldurun' },
        4: { title: 'âš¡ ÅimÅŸek LagÃ¼nÃ¼', desc: 'Zamana karÅŸÄ± hÄ±zlÄ± test' },
        5: { title: 'ğŸŒ€ Senaryo Labirenti', desc: 'Ä°nteraktif senaryolar' }
      };
      document.getElementById('zoneTitle').textContent = zoneInfo[zoneNum].title;
      document.getElementById('zoneDescription').textContent = zoneInfo[zoneNum].desc;
      document.getElementById('currentScore').textContent = '0';

      if (zoneNum === 1) initZone1();
      if (zoneNum === 2) initZone2();
      if (zoneNum === 3) initZone3();
      if (zoneNum === 4) initZone4();
      if (zoneNum === 5) initZone5();
    }

    // ZONE 1
    function initZone1() {
      const idioms = [...idiomsData.zone1];
      const meanings = idioms.map(i => i.meaning).sort(() => Math.random() - 0.5);
      gameData.gameState = { idioms, meanings, matches: {} };
      document.getElementById('matchProgress').textContent = `0/${idioms.length}`;
      document.getElementById('matchProgressBar').style.width = '0%';
      renderMatchingGame();
    }

    function renderMatchingGame() {
      const idiomsCol = document.getElementById('idiomsColumn');
      const meaningsCol = document.getElementById('meaningsColumn');
      idiomsCol.innerHTML = '';
      meaningsCol.innerHTML = '';

      gameData.gameState.idioms.forEach(item => {
        const d = document.createElement('div');
        d.className = 'drag-item bg-blue-100 border-2 border-blue-300 rounded-lg p-3 text-center';
        d.draggable = true;
        d.textContent = item.idiom;
        d.dataset.idiom = item.idiom;
        d.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text/plain', item.idiom);
        });
        idiomsCol.appendChild(d);
      });

      gameData.gameState.meanings.forEach(m => {
        const d = document.createElement('div');
        d.className = 'drop-zone bg-gray-50 border-2 border-gray-300 rounded-lg p-3 flex items-center justify-center';
        d.dataset.meaning = m;
        d.textContent = m;
        d.addEventListener('dragover', e => { e.preventDefault(); d.classList.add('drag-over'); });
        d.addEventListener('dragleave', () => d.classList.remove('drag-over'));
        d.addEventListener('drop', e => {
          e.preventDefault();
          d.classList.remove('drag-over');
          const idi = e.dataTransfer.getData('text/plain');
          if (!idi) return;
          const oldIdiom = Object.keys(gameData.gameState.matches).find(key => gameData.gameState.matches[key] === m);
          if (oldIdiom) {
              delete gameData.gameState.matches[oldIdiom];
              document.querySelector(`[data-idiom="${oldIdiom}"]`).style.opacity = '1';
          }
          gameData.gameState.matches[idi] = m;
          d.innerHTML = `<div class="font-semibold text-blue-800">${idi}</div>`;
          d.classList.add('bg-blue-50', 'border-blue-400');
          document.querySelector(`[data-idiom="${idi}"]`).style.opacity = '0.3';
          updateMatchProgress();
        });
        meaningsCol.appendChild(d);
      });
    }

    function updateMatchProgress() {
      const count = Object.keys(gameData.gameState.matches).length;
      const total = gameData.gameState.idioms.length;
      document.getElementById('matchProgress').textContent = `${count}/${total}`;
      document.getElementById('matchProgressBar').style.width = `${(count / total) * 100}%`;
    }

    function checkMatches() {
      let correctCount = 0;
      gameData.gameState.idioms.forEach(item => {
          const matchedMeaning = gameData.gameState.matches[item.idiom];
          const isCorrect = matchedMeaning === item.meaning;
          if (isCorrect) correctCount++;
          
          const dropZoneEl = document.querySelector(`[data-meaning="${matchedMeaning}"]`);
          if (dropZoneEl) {
              dropZoneEl.classList.add(isCorrect ? 'correct-match' : 'wrong-match');
          }
      });
      const score = correctCount * 10;
      gameData.zoneScores[0] = score;
      gameData.totalScore += score;
      if (correctCount >= 8) gameData.unlockedZones[1] = true;
      showResults(1, score, correctCount, gameData.gameState.idioms.length);
    }

    // ZONE 2
    function initZone2() {
      gameData.gameState = {
        questions: [...idiomsData.zone2].sort(() => Math.random() - 0.5),
        currentQ: 0,
        score: 0,
        lives: 3,
        correctAnswers: 0
      };
      showTrueFalseQuestion();
    }

    function showTrueFalseQuestion() {
      const s = gameData.gameState;
      const q = s.questions[s.currentQ];
      document.getElementById('tfQuestionNum').textContent = s.currentQ + 1;
      document.getElementById('livesCount').textContent = 'â¤ï¸'.repeat(s.lives);
      document.getElementById('tfIdiom').textContent = q.idiom;
      document.getElementById('tfDefinition').textContent = `AnlamÄ±: "${q.meaning}"`;
      document.getElementById('tfProgressBar').style.width = `${((s.currentQ + 1) / s.questions.length) * 100}%`;
    }

    function answerTrueFalse(userAns) {
      const s = gameData.gameState;
      if (s.currentQ >= s.questions.length) return;
      const q = s.questions[s.currentQ];
      if (userAns === q.correct) {
        s.score += 10;
        s.correctAnswers++;
      } else {
        s.lives--;
      }
      document.getElementById('currentScore').textContent = s.score;
      s.currentQ++;
      
      if (s.lives <= 0) {
        gameData.zoneScores[1] = s.score;
        gameData.totalScore += s.score;
        showResults(2, s.score, s.correctAnswers, s.questions.length, true); // Game over
        return;
      }

      if (s.currentQ >= s.questions.length) {
        gameData.zoneScores[1] = s.score;
        gameData.totalScore += s.score;
        if(s.correctAnswers >= 8) gameData.unlockedZones[2] = true;
        showResults(2, s.score, s.correctAnswers, s.questions.length);
      } else {
        showTrueFalseQuestion();
      }
    }

    // ZONE 3
    function initZone3() {
      gameData.gameState = {
        questions: [...idiomsData.zone3].sort(() => Math.random() - 0.5),
        currentQ: 0,
        score: 0,
        correctAnswers: 0
      };
      showFillBlankQuestion();
    }

    function showFillBlankQuestion() {
      const s = gameData.gameState;
      const q = s.questions[s.currentQ];
      document.getElementById('fibQuestionNum').textContent = s.currentQ + 1;
      document.getElementById('fibSentence').textContent = q.sentence;
      document.getElementById('fibProgressBar').style.width = `${((s.currentQ + 1) / s.questions.length) * 100}%`;
      const sel = document.getElementById('fibSelect');
      sel.innerHTML = `<option value="">SeÃ§iniz...</option>`;
      q.options.sort(() => Math.random() - 0.5).forEach(o => {
        const opt = document.createElement('option');
        opt.value = o;
        opt.textContent = o;
        sel.appendChild(opt);
      });
      document.getElementById('bonusSentence').value = '';
      document.getElementById('bonusSentence').disabled = false;
    }

    function submitFillBlank() {
      const s = gameData.gameState;
      if (s.currentQ >= s.questions.length) return;
      const q = s.questions[s.currentQ];
      const ans = document.getElementById('fibSelect').value;
      if (!ans) {
        alert('LÃ¼tfen bir deyim seÃ§in!');
        return;
      }
      if (ans === q.answer) {
        s.score += 15;
        s.correctAnswers++;
      }
      document.getElementById('currentScore').textContent = s.score;
      s.currentQ++;
      if (s.currentQ >= s.questions.length) {
        gameData.zoneScores[2] = s.score;
        gameData.totalScore += s.score;
        if(s.correctAnswers >= 4) gameData.unlockedZones[3] = true;
        showResults(3, s.score, s.correctAnswers, s.questions.length);
      } else {
        showFillBlankQuestion();
      }
    }

    function submitBonus() {
      const txt = document.getElementById('bonusSentence').value.trim();
      if (txt.length > 10) {
        gameData.gameState.score += 5;
        document.getElementById('currentScore').textContent = gameData.gameState.score;
        alert('+5 bonus puan!');
        document.getElementById('bonusSentence').value = '';
        document.getElementById('bonusSentence').disabled = true;
      } else {
        alert('Bonus kazanmak iÃ§in daha uzun bir cÃ¼mle yazÄ±n!');
      }
    }

    // ZONE 4
    function initZone4() {
        gameData.gameState = {
            questions: [...idiomsData.zone4].sort(() => Math.random() - 0.5),
            currentQ: 0,
            score: 0,
            timeLeft: 60,
            correctAnswers: 0,
            timer: null
        };
        document.getElementById('timerDisplay').classList.remove('hidden');
        document.getElementById('lrTimer').classList.remove('timer-warning');
        document.getElementById('lrTimer').textContent = gameData.gameState.timeLeft;
        gameData.gameState.timer = setInterval(() => {
            gameData.gameState.timeLeft--;
            document.getElementById('lrTimer').textContent = gameData.gameState.timeLeft;
            if (gameData.gameState.timeLeft <= 10) {
                document.getElementById('lrTimer').classList.add('timer-warning');
            }
            if (gameData.gameState.timeLeft <= 0) {
                finishLightningRound();
            }
        }, 1000);
        showLightningQuestion();
    }

    function showLightningQuestion() {
        const s = gameData.gameState;
        const q = s.questions[s.currentQ];
        document.getElementById('lrQuestionNum').textContent = s.currentQ + 1;
        document.getElementById('lrIdiom').textContent = q.idiom;
        document.getElementById('lrProgressBar').style.width = `${((s.currentQ + 1) / s.questions.length) * 100}%`;
        const optionsContainer = document.getElementById('lrOptions');
        optionsContainer.innerHTML = '';
        q.options.forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.className = 'bg-yellow-100 hover:bg-yellow-200 border-2 border-yellow-300 rounded-lg p-4 font-semibold';
            btn.textContent = opt;
            btn.onclick = () => answerLightning(index);
            optionsContainer.appendChild(btn);
        });
    }

    function answerLightning(selectedIndex) {
        const s = gameData.gameState;
        if (s.currentQ >= s.questions.length) return;
        const q = s.questions[s.currentQ];
        if (selectedIndex === q.answer) {
            s.score += 10 + Math.floor(s.timeLeft / 10);
            s.correctAnswers++;
        }
        document.getElementById('currentScore').textContent = s.score;
        s.currentQ++;
        if (s.currentQ >= s.questions.length) {
            finishLightningRound();
        } else {
            showLightningQuestion();
        }
    }

    function finishLightningRound() {
        const s = gameData.gameState;
        clearInterval(s.timer);
        document.getElementById('timerDisplay').classList.add('hidden');
        gameData.zoneScores[3] = s.score;
        gameData.totalScore += s.score;
        if (s.correctAnswers >= 4) gameData.unlockedZones[4] = true;
        showResults(4, s.score, s.correctAnswers, s.questions.length);
    }

    // ZONE 5
    function initZone5() {
        gameData.gameState = {
            scenarios: [...idiomsData.zone5].sort(() => Math.random() - 0.5),
            currentS: 0,
            score: 0,
            correctAnswers: 0
        };
        showScenario();
    }

    function showScenario() {
        const s = gameData.gameState;
        const scenario = s.scenarios[s.currentS];
        document.getElementById('scenarioNum').textContent = s.currentS + 1;
        document.getElementById('scenarioTitle').textContent = scenario.title;
        document.getElementById('scenarioDescription').textContent = scenario.description;
        document.getElementById('scenarioQuestion').textContent = scenario.question;
        document.getElementById('scenarioProgressBar').style.width = `${((s.currentS + 1) / s.scenarios.length) * 100}%`;
        const optionsContainer = document.getElementById('scenarioOptions');
        optionsContainer.innerHTML = '';
        scenario.options.forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.className = 'bg-purple-100 hover:bg-purple-200 border-2 border-purple-300 rounded-lg p-4 text-left w-full';
            btn.innerHTML = `<div class="font-semibold">${opt.text}</div><div class="text-sm text-gray-600 mt-1">KullanÄ±lan: "${opt.idiom}"</div>`;
            btn.onclick = () => answerScenario(index);
            optionsContainer.appendChild(btn);
        });
    }

    function answerScenario(selectedIndex) {
        const s = gameData.gameState;
        if (s.currentS >= s.scenarios.length) return;
        const scenario = s.scenarios[s.currentS];
        if (scenario.options[selectedIndex].correct) {
            s.score += 25;
            s.correctAnswers++;
        }
        document.getElementById('currentScore').textContent = s.score;
        s.currentS++;
        if (s.currentS >= s.scenarios.length) {
            gameData.zoneScores[4] = s.score;
            gameData.totalScore += s.score;
            showResults(5, s.score, s.correctAnswers, s.scenarios.length);
        } else {
            showScenario();
        }
    }

    // RESULTS & NAVIGATION
    function showResults(zone, score, correct, total, gameOver = false) {
      const modal = document.getElementById('resultsModal');
      const icon = document.getElementById('resultsIcon');
      const title = document.getElementById('resultsTitle');
      const message = document.getElementById('resultsMessage');
      const scoreDisplay = document.getElementById('resultsScore');
      const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;
      
      if (gameOver) {
          icon.textContent = 'ğŸ’”';
          title.textContent = 'Oyun Bitti!';
          message.textContent = `CanlarÄ±n bitti. Pratik yap ve tekrar dene!`;
      } else if (percentage >= 80) {
        icon.textContent = 'ğŸ‰';
        title.textContent = 'Harika Ä°ÅŸ!';
        message.textContent = `Bu bÃ¶lÃ¼mÃ¼ %${percentage} baÅŸarÄ±yla tamamladÄ±n!`;
      } else if (percentage >= 50) {
        icon.textContent = 'ğŸ‘';
        title.textContent = 'Ä°yi Ä°ÅŸ!';
        message.textContent = `%${percentage} doÄŸru yaptÄ±n. PratiÄŸe devam!`;
      } else {
        icon.textContent = 'ğŸ’ª';
        title.textContent = 'Denemeye Devam Et!';
        message.textContent = `%${percentage} doÄŸru yaptÄ±n. Pratik mÃ¼kemmelleÅŸtirir!`;
      }
      
      scoreDisplay.textContent = `+${score} puan`;
      modal.classList.remove('hidden');
    }

    function closeResults() {
      document.getElementById('resultsModal').classList.add('hidden');
      returnToMenu();
    }

    function returnToMenu() {
      document.getElementById('gameScreen').classList.add('hidden');
      document.getElementById('mainMenu').classList.remove('hidden');
      updateDisplay();
    }
    
    // Initialize the game when page loads
    document.addEventListener('DOMContentLoaded', initGame);
  </script>
</body>
</html>